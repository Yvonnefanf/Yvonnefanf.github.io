<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Comparable XAI</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    table {
      /* width: 100%; */
      border-collapse: collapse;
      margin-bottom: 10px;
      font-size: 14px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
      transition: max-width 0.4s cubic-bezier(0.4,0,0.2,1), opacity 0.4s cubic-bezier(0.4,0,0.2,1), padding 0.4s cubic-bezier(0.4,0,0.2,1);
      max-width: 200px;
      opacity: 1;
      overflow: hidden;
      white-space: nowrap;
    }
    th {
      background-color: #f0f8ff;
    }
    .highlight-blue {
      background-color: #dcecfb;
    }
    .highlight-green {
      background-color: #d9f5dc;
    }
    .hidden {
      max-width: 0 !important;
      opacity: 0 !important;
      padding-left: 0 !important;
      padding-right: 0 !important;
      border-width: 0 !important;
      pointer-events: none;
    }
    .comp1, .comp2 {
      background-color: #fef6e4;
      transition: max-width 0.4s cubic-bezier(0.4,0,0.2,1), opacity 0.4s cubic-bezier(0.4,0,0.2,1), padding 0.4s cubic-bezier(0.4,0,0.2,1), border-width 0.4s cubic-bezier(0.4,0,0.2,1);
    }
    .sub-header {
      background-color: #f0f0f0;
      font-weight: normal;
      font-size: 0.9em;
    }
    .clickable-header {
      cursor: pointer;
      user-select: none;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-weight: bold;
      color: #0074d9;
      transition: color 0.2s;
    }
    .clickable-header:hover {
      color: #005fa3;
    }
    .arrow {
      transition: transform 0.2s;
      display: inline-block;
    }
    .arrow.open {
      transform: rotate(180deg);
    }
    .toggle-text {
      width: 90px;
    }
    .toggle-text:hover {
      text-decoration: underline;
    }
    .tabs {
      display: flex;
      gap: 0;
      margin-bottom: 18px;
      border-bottom: 2.5px solid #e5e7eb;
      background: #fff;
    }
    .tab {
      cursor: pointer;
      padding: 12px 32px 10px 32px;
      border: none;
      background: none;
      font-size: 1.08em;
      font-weight: 500;
      color: #888;
      position: relative;
      transition: color 0.2s, background 0.2s;
      border-radius: 12px 12px 0 0;
      outline: none;
      margin-bottom: -2.5px;
    }
    .tab:not(.active):hover {
      color: #0074d9;
      background: #f5faff;
    }
    .tab.active {
      color: #222;
      font-weight: 700;
      background: #fff;
    }
    .tab.active::after {
      content: '';
      display: block;
      position: absolute;
      left: 18px;
      right: 18px;
      bottom: -2.5px;
      height: 3.5px;
      border-radius: 2px 2px 0 0;
      background: #0074d9;
      box-shadow: 0 2px 8px 0 #0074d91a;
    }
    .adj-flex {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
    }
    .adj-grey {
      color: #ccc;
      font-size: 1em;
      width: 30px;
      text-align: right;
    }
    .adj-black {
      color: #222;
      font-weight: 500;
      font-size: 1em;
      width: 40px;
      text-align: left;
    }
    .plain-xai-table {
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 14px;
      min-width: 650px;
    }
    .plain-xai-table th, .plain-xai-table td {
      border: 1px solid #bfc9d1;
      padding: 6px 12px;
      text-align: center;
    }
    .plain-xai-table th {
      font-weight: bold;
    }
    .plain-xai-table tr td:first-child {
  
      font-weight: 500;
    }
  </style>
</head>
<body>

<div id="app">
<h2>
  <div class="tabs">
    <span v-for="(tab, idx) in tabs" :key="tab" :class="['tab', {active: currentTab === idx}]" @click="currentTab = idx">{{ tab }}</span>
  </div>
</h2>
<div v-if="currentTab === 0">
  <table>
    <thead>
      <tr>
        <th rowspan="2" style="width: 140px;">Feature</th>
        <th colspan="3" class="comp1-header" style="position:relative;">
          <div style="display:flex;align-items:center;justify-content:center;">
            Comp1 Adjustment
            <span class="clickable-header" style="margin-left: 10px;" @click="toggleCols('comp1')">
              <span class="toggle-text">{{ comp1Open ? 'Hide Details' : 'Show Details' }}</span>
              <span class="arrow">
                <i :class="comp1Open ? 'fa-solid fa-angle-left' : 'fa-solid fa-angle-right'"></i>
              </span>
            </span>
          </div>
        </th>
        <th colspan="8" class="comp1" :class="{hidden: !comp1Open}">Comp1 adjust step</th>
        <th colspan="3" class="comp2-header" style="position:relative;">
          <div style="display:flex;align-items:center;justify-content:center;">
            Comp2 Adjustment
            <span class="clickable-header" style="margin-left: 10px;" @click="toggleCols('comp2')">
              <span class="toggle-text">{{ comp2Open ? 'Hide Details' : 'Show Details' }}</span>
              <span class="arrow">
                <i :class="comp2Open ? 'fa-solid fa-angle-left' : 'fa-solid fa-angle-right'"></i>
              </span>
            </span>
          </div>
        </th>
        <th colspan="10" class="comp2" :class="{hidden: !comp2Open}">Comp2 adjust step</th>
        <th colspan="2">Target</th>
      </tr>
      <tr class="sub-header">
        <th style="width: 80px;" class="comp1-header">Feature <br/>Adjustment</th>
        <th style="width: 70px;" class="comp1-header">AI Pred: <br/>  $ 372.7 K</th>
        <th style="width: 70px;" class="comp1-header highlight-green">Actual: <br/> $ 390.0 K</th>
        <th colspan="2" class="comp1" :class="{hidden: !comp1Open}">Adjust 1</th>
        <th colspan="2" class="comp1" :class="{hidden: !comp1Open}">Adjust 2</th>
        <th colspan="2" class="comp1" :class="{hidden: !comp1Open}">Adjust 3</th>
        <th colspan="2" class="comp1" :class="{hidden: !comp1Open}">Adjust 4</th>
        <th style="width: 80px;" class="comp2-header">Feature <br/>Adjustment</th>
        <th style="width: 70px;" class="comp2-header">AI Pred: <br/> $ 231.7 K </th>
        <th style="width: 70px;"class="comp2-header highlight-green">Actual: <br/> $ 245.0 K</th>
        <th colspan="2" class="comp2" :class="{hidden: !comp2Open}">Adjust 1</th>
        <th colspan="2" class="comp2" :class="{hidden: !comp2Open}">Adjust 2</th>
        <th colspan="2" class="comp2" :class="{hidden: !comp2Open}">Adjust 3</th>
        <th colspan="2" class="comp2" :class="{hidden: !comp2Open}">Adjust 4</th>
        <th colspan="2" class="comp2" :class="{hidden: !comp2Open}">Adjust 5</th>
        <th style="width: 30px;">Feature </th>
        <th style="width: 60px;">AI Pred: <br/> $ 389.0 K </th>
      </tr>
    </thead>
    <tbody>
      <tr v-for="row in tableRows" :key="row.attribute">
        <td>{{ row.attribute }}</td>
        <td class="comp1-header"><span class="adj-flex"><span class="adj-grey">{{ row.comp1.featureAdj[0] }}</span><span class="adj-black">{{ row.comp1.featureAdj[1] }}</span></span></td>
        <template v-if="Array.isArray(row.comp1.value)">
          <td class="comp1-header">{{ row.comp1.value[0] }}</td>
          <td class="comp1-header">{{ row.comp1.value[1] }}</td>
        </template>
        <td v-else class="comp1-header" colspan="2">{{ row.comp1.value }}</td>
        <td v-for="(detail, i) in row.comp1.details" :key="'c1d'+i" class="comp1" 
          :class="{hidden: !comp1Open}"
          :style="{ color: row.comp1.colorBIndex?.includes(i) ? '#222' : '#ccc' }">{{ detail }}</td>
        <td class="comp2-header"><span class="adj-flex"><span class="adj-grey">{{ row.comp2.featureAdj[0] }}</span><span class="adj-black">{{ row.comp2.featureAdj[1] }}</span></span></td>
        <template v-if="Array.isArray(row.comp2.value)">
          <td class="comp2-header">{{ row.comp2.value[0] }}</td>
          <td class="comp2-header">{{ row.comp2.value[1] }}</td>
        </template>
        <td v-else class="comp2-header" colspan="2">{{ row.comp2.value }}</td>
        <td v-for="(detail, i) in row.comp2.details" :key="'c2d'+i" class="comp2" 
          :class="{hidden: !comp2Open}"
          :style="{ color: row.comp2.colorBIndex?.includes(i) ? '#222' : '#ccc' }">{{ detail }}</td>
        <td colspan="2" style="text-align: left;">{{ row.target }}</td>
      </tr>
    </tbody>
  </table>
</div>
<div v-else-if="currentTab === 1">
  <table>
    <thead>
      <tr>
        <th rowspan="2" style="width: 140px;">Feature</th>
        <th :colspan="3" @click="toggleCols('comp1')" class="comp1-header" v-if="!comp2Open">
          Comp1 Adjustment 
        </th>
        <th :colspan="3" @click="toggleCols('comp2')" class="comp2-header" v-if="!comp1Open">
          Comp2 Adjustment 
        </th>
        <th colspan="2">Target</th>
      </tr>
      <tr class="sub-header">
        <th style="width: 80px;" class="comp1-header" v-if="!comp2Open">Feature <br/>Adjustment</th>
        <th style="width: 70px;" class="comp1-header" v-if="!comp2Open">AI Pred: <br/>  $ 372.7 K</th>
        <th style="width: 70px;" class="comp1-header highlight-green" v-if="!comp2Open">Actual: <br/> $ 390.0 K</th>

        <th style="width: 80px;" class="comp2-header" v-if="!comp1Open">Feature <br/>Adjustment</th>
        <th style="width: 70px;" class="comp2-header" v-if="!comp1Open">AI Pred: <br/> $ 231.7 K </th>
        <th style="width: 70px;"class="comp2-header highlight-green" v-if="!comp1Open">Actual: <br/> $ 245.0 K</th>
        <th style="width: 30px;">Feature </th>
        <th style="width: 60px;">AI Pred: <br/> $ 389.0 K </th>
      </tr>
    </thead>
    <tbody>
      <tr v-for="row in tableRows_no_trace" :key="row.attribute">
        <td>{{ row.attribute }}</td>
        <td class="comp1-header" v-if="!comp2Open"><span class="adj-flex"><span class="adj-grey">{{ row.comp1.featureAdj[0] }}</span><span class="adj-black">{{ row.comp1.featureAdj[1] }}</span></span></td>
        <template v-if="!comp2Open">
          <template v-if="Array.isArray(row.comp1.value)">
            <td class="comp1-header">{{ row.comp1.value[0] }}</td>
            <td class="comp1-header">{{ row.comp1.value[1] }}</td>
          </template>
          <td v-else class="comp1-header" colspan="2">{{ row.comp1.value }}</td>
        </template>
        <td class="comp2-header" v-if="!comp1Open"><span class="adj-flex"><span class="adj-grey">{{ row.comp2.featureAdj[0] }}</span><span class="adj-black">{{ row.comp2.featureAdj[1] }}</span></span></td>
        <template v-if="!comp1Open">
          <template v-if="Array.isArray(row.comp2.value)">
            <td class="comp2-header">{{ row.comp2.value[0] }}</td>
            <td class="comp2-header">{{ row.comp2.value[1] }}</td>
          </template>
          <td v-else class="comp2-header" colspan="2">{{ row.comp2.value }}</td>

        </template>
        <td colspan="2" style="text-align: left;">{{ row.target }}</td>
      </tr>
    </tbody>
  </table>
</div>
<div v-else class="tab-content">
  <table class="plain-xai-table">
    <thead>
      <tr>
  
        <th rowspan="2" style="width: 140px;">Feature</th>
        <th colspan="2">Target</th>
        <th colspan="2">Comp1</th>
        <th colspan="2">Comp2</th>
      </tr>
      <tr>
        <th class="plain-xai-pred">Pred <br/> $ 389.0K </th>
        <th class="plain-xai-actual highlight-green">Actual  <br/> ?? </th>
        <th class="plain-xai-pred">Pred  <br/> $ 372.7 K </th>
        <th class="plain-xai-actual highlight-green">Actual  <br/> $ 390.0 K </th>
        <th class="plain-xai-pred">Pred  <br/> $ 231.7 K </th>
        <th class="plain-xai-actual highlight-green">Actual  <br/> $ 245.0 K </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Dis to Downtown</td>
        <td colspan="2">12.4</td>
        <td colspan="2">12.1</td>
        <td colspan="2">10.5</td>
      </tr>
      <tr>
        <td># Bathroom</td>
        <td colspan="2">1</td>
        <td colspan="2">2</td>
        <td colspan="2">1</td>
      </tr>
      <tr>
        <td>Size</td>
        <td colspan="2">1.38</td>
        <td colspan="2">1.08</td>
        <td colspan="2">0.71</td>
      </tr>
      <tr>
        <td>Grade</td>
        <td colspan="2">7</td>
        <td colspan="2">7</td>
        <td colspan="2">6</td>
      </tr>
      <tr>
        <td>Age</td>
        <td colspan="2">68</td>
        <td colspan="2">68</td>
        <td colspan="2">73</td>
      </tr>
      <tr>
        <td>Condition</td>
        <td colspan="2">4</td>
        <td colspan="2">5</td>
        <td colspan="2">3</td>
      </tr>
    </tbody>
  </table>
</div>
</div>

<script>
const { createApp } = Vue;
createApp({
  data() {
    return {
      comp1Open: false,
      comp2Open: false,
      currentTab: 0,
      tabs: [
        'Comparable XAI',
        'Comparable XAI (No Trace)',
        'Plain Example-based XAI'
      ],
      tableRows: [
        {
          attribute: 'Dis to Downtown',
          comp1: {
            featureAdj: ['12.1', '+ 0.3'],
            value: '- $ 3K',
            details: ['','','','','+ 0.3','- $ 3K','+ 0.3','- $ 3K'],
            colorBIndex: [4,5]
          },
          comp2: {
            featureAdj: ['10.5', '+ 1.8'],
            value: '- $ 113K',
            details: ['+ 1.8','- $ 113K','+ 1.8','- $ 113K','+ 1.8','- $ 113K','+ 1.8','- $ 113K','+ 1.8','- $ 113K'],
            colorBIndex: [0,1]
          },
          target: '12.4'
        },
        {
          attribute: '# Bathroom',
          comp1: {
            featureAdj: ['2', '− 1'] ,
            value: '- $ 6K',
            details: ['- 1','- $6 K','- 1','- $6 K','- 1','- $6 K','- 1','- $6 K'],
            colorBIndex: [0,1]
          },
          comp2: {
            featureAdj: ['1', ''],
            value: '',
            details: ['','','','','','','','','','']
          },
          target: '1'
        },
        {
          attribute: 'Size',
          comp1: {
            featureAdj: ['1.08', '+ 0.3'],
            value: '+ $ 30K',
            details: ['','','+ 0.3','+ $ 30K','+ 0.3','+ $ 30K','+ 0.3','+ $ 30K'],
            colorBIndex: [2,3]
          },
          comp2: {
            featureAdj: ['0.71', '+ 0.67'],
            value: '+ $ 135K',
            details: ['','','+ 0.67','+ $ 135K','+ 0.67','+ $ 135K','+ 0.67','+ $ 135K','+ 0.67','+ $ 135K'],
            colorBIndex: [2,3]
          },
          target: '1.38'
        },
        {
          attribute: 'Grade',
          comp1: {
            featureAdj: ['7', ''],
            value: '',
            details: ['','','','','','','','']
          },
          comp2: {
            featureAdj: ['6', '+ 1'],
            value: '+ $ 97K',
            details: ['','','','','+ 1','+ $ 97K','+ 1','+ $ 97K','+ 1','+ $ 97K'],
            colorBIndex: [4,5]
          },
          target: '7'
        },
        {
          attribute: 'Age',
          comp1: {
            featureAdj: ['68', ''],
            value: '',
            details: ['','','','','','','','']
          },
          comp2: {
            featureAdj: ['73', '- 7'],
            value: '+ $ 7K',
            details: ['','','','','','','- 7','+ $ 7K','- 7','+ $ 7K'],
            colorBIndex: [6,7]
          },
          target: '68'
        },
        {
          attribute: 'Condition',
          comp1: {
            featureAdj: ['5', '- 1'],
            value: '- $ 3K',
            details: ['','','','','','','- 1','- $ 3K'],
            colorBIndex: [6,7]
          },
          comp2: {
            featureAdj: ['3', '+ 1'],
            value: '+ $ 22K',
            details: ['','','','','','','','','+ 1','+ $ 22K'],
            colorBIndex: [8,9]
          },
          target: '4'
        },
        {
          attribute: 'Adjusted Price',
          comp1: {
            featureAdj: ['',''],
            value: ['= $ 390.7 K','= $ 408.0 K'],
            details: ['','-$ 6k','','+ $ 24K','','+ $ 21K','','+ $ 18K'],
            colorBIndex: [0,1,2,3,4,5,6,7]
          },
          comp2: {
            featureAdj: ['',''],
            value: ['= $ 379.7 K','= $ 393.0 K'],
            details: ['','- $ 113K','','+ $ 22K','','+ $ 119K','','+ $ 126K','','+ $ 148K'],
            colorBIndex: [0,1,2,3,4,5,6,7,8,9]
          },
          target: ''
        }
      ],
      tableRows_no_trace: [
        {
          attribute: 'Dis to Downtown',
          comp1: {
            featureAdj: ['12.1', '+ 0.3'],
            value: '+ $ 11K',
          },
          comp2: {
            featureAdj: ['10.5', '+ 1.8'],
            value: '- $ 67K',
          },
          target: '12.4'
        },
        {
          attribute: '# Bathroom',
          comp1: {
            featureAdj: ['2', '− 1'] ,
            value: '- $ 6K',
          },
          comp2: {
            featureAdj: ['1', ''],
            value: '',
          },
          target: '1'
        },
        {
          attribute: 'Size',
          comp1: {
            featureAdj: ['1.08', '+ 0.3'],
            value: '- $ 10K',
          },
          comp2: {
            featureAdj: ['0.71', '+ 0.67'],
            value: '+ $ 154K',
          },
          target: '1.38'
        },
        {
          attribute: 'Grade',
          comp1: {
            featureAdj: ['7', ''],
            value: '',
          },
          comp2: {
            featureAdj: ['6', '+ 1'],
            value: '+ $ 150K',
          },
          target: '7'
        },
        {
          attribute: 'Age',
          comp1: {
            featureAdj: ['68', ''],
            value: '',
          },
          comp2: {
            featureAdj: ['73', '- 7'],
            value: '+ $ 6K'
          },
          target: '68'
        },
        {
          attribute: 'Condition',
          comp1: {
            featureAdj: ['5', '- 1'],
            value: '+ $ 1.5K',
            
          },
          comp2: {
            featureAdj: ['3', '+ 1'],
            value: '+ $ 35K'
          },
          target: '4'
        },
        {
          attribute: 'Adjusted Price',
          comp1: {
            featureAdj: ['',''],
            value: ['= $ 369.0 K','= $ 386.0 K'],
          },
          comp2: {
            featureAdj: ['',''],
            value: ['= $ 510.9 K','= $ 524.1 K'],
          },
          target: ''
        }
      ]
    }
  },
  methods: {
    toggleCols(group) {
      if (group === 'comp1') {
        this.comp1Open = !this.comp1Open;
        if (this.comp1Open) this.comp2Open = false;
      } else {
        this.comp2Open = !this.comp2Open;
        if (this.comp2Open) this.comp1Open = false;
      }
    }
  }
}).mount('#app');
</script>

</body>
</html>
